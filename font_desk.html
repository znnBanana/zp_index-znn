<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./bootstrap/css/bootstrap.css">
    <link href="https://cdn.bootcss.com/font-awesome/5.10.2/css/all.css" rel="stylesheet">
    <script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.min.js"></script>
    <script type="text/javascript" src="./bootstrap/js/bootstrap.js"></script>
    <title>招聘网站前台</title>
    <style>
        ul{
            list-style-type: none;
        }
        .wrapper{
            width: 80%;
            margin: 0 auto;
        }
        .wrapper  #job_hunter{
            padding: 0;
            height: 80px;
            margin-right: 0;
            margin-left: 0;
        }
        .wrapper  #job_hunter .image{
            line-height: 80px;
        }
        .wrapper  #job_hunter .search{
            position: relative;
            border: 2px solid #0a80f5;
            height: 40px;
            border-radius: 5px;
        }
        .wrapper  #job_hunter .search .search_input{
            border: none;
        }
        .wrapper  #job_hunter .search .btn_job{
            position: absolute;
            right: 0;
            height: 100%;
        }
        .job ul li, .address ul li, .welfare ul li, .selected ul li{
            display: inline-block;
            padding: 0 1em;
        }
        .selected{
            border-bottom: 2px solid #0a80f5;
        }
        .welfare .one,.welfare .two,.welfare .three{
            display: inline-block;
        }
        .welfare .one{
            background-color: #8080c0;
            width: 75px;
        }
        .welfare .two{
            background-color: #0080c0;
            width: 55px;
        }
        .welfare .three{
            background-color: #008000;
            width: 55px;
        }
        .recruit{
            border-bottom: 1px solid #ccc;
        }
        .recruit .sign_up{
            background-color: #0080c0;
            width: 150px;
            height: 30px;
            text-align: center;
            font-size: 14px;
            font-weight: bold;
            color: white;
            line-height: 2em;
        }
        .current{
            background-color: #0080c0;
            color: #fff;
        }
    </style>
</head>
<body>
    <div class="container-fluid">
        <!-- top -->
        <div class="row border-bottom">
            <!-- 切换城市 -->
            <label for="switch_city" class="text-info text-right font-weight-bold col-2">北京</label>
            <div id="switch_city" class="ml-1 col-1"> [切换城市]</div> 
            <!-- 登录注册 -->
            <div class="login col-6 text-right">登录 / 注册</div> 
            <!-- 个人中心 -->
            <div class="self_center text-right col-1">
                <a href="javascript:void(0)">个人中心<i class="fa fa-chevron-down"></i></a>
            </div>
            <!-- 商家中心 -->
            <div class="business_center col-1">
                <a href="javascript:void(0)">商家中心<i class="fa fa-chevron-down"></i></a>
            </div>
        </div>
        <div class="wrapper">
            <!-- 招聘区域 -->
            <div id="job_hunter" class="row border-bottom">
                <!-- 图片 -->
                <div class="image col-3">
                    <img src="./images/zhaopin.png" alt="">
                </div>
                <!-- 搜索区域 -->
                <div class="search col-6 mt-4">
                    <i class="fa fa-search text-secondary"></i><input class="search_input" type="text" placeholder="请输入需要搜索的职位"/>
                    <input class="btn_job bg-info text-white border-0 rounded-0" type="button" value="搜索职位">   

                </div>
                <!-- 发布职位 -->
                <div class="post_jobs text-right btn col-3 mt-3">
                    <div id="post" class="btn bg-warning"><i class="fa fa-info-circle"></i> 发布职位</div>
                </div>   
            </div>
            <!-- 职位，地点，福利区域 -->
            <div class="types">
                <div class="job border-bottom">
                    <div class="mt-2">职位：</div>
                    <div>
                        <ul id="add_job">
                            <li class="current">全部</li>
                        </ul>
                    </div>            
                </div>
                <div class="address border-bottom">
                    <div class="mt-2">地点：</div>
                    <div>
                        <ul id="add_address">
                            <li class="current">不限</li>
                        </ul>
                    </div>
                </div>
                <div class="welfare border-bottom">
                    <div class="mt-2">福利：</div>
                    <div>
                        <ul id="add_welfare">
                            <li class="current">不限</li>
                        </ul>
                    </div>
                </div>
                <div class="selected">
                    <div class="mt-2">已选：</div>
                    <div>
                        <ul id="add_selected">
                            <!-- <li class="current">全部</li> -->
                        </ul>
                    </div>
                </div>
            </div>
            <!-- 招聘详情 -->
            <div class="recruit">
                <!-- <div class="row">
                    <div class="recruit_details_left mt-2 col-4">
                        <div class="title">190/天上一休一连锁超市急招营业员</div>
                        <div class="salary text-danger">4000-5000元/月</div>
                        <div class="welfare btn">
                            <div class="one">五险一金</div>
                            <div class="two">包吃</div>
                            <div class="three">包住</div>
                        </div>
                    </div>
                    <div class="recruit_details_center mt-3 col-5">
                        <div >
                            <span class="workTime">工作时间：全职工作</span>&nbsp;&nbsp;&nbsp;
                            <span class="job">工作类型：收银员</span>
                        </div>
                        <div>
                            <span class="num">招聘人数：10人</span>&nbsp;&nbsp;&nbsp;
                            <span class="location">工作地点：海淀知春路</span>
                        </div>
                    </div>
                    <div class="recruit_details_right col-3">
                        <div class="sign_up mt-5">报名参加</div>
                    </div>
                </div> -->
            </div>            
        </div>        
    </div>

    <!-- ================recruit模态框================= -->
    <div class="modal fade" id="modal_add_recruit" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg" role="document">
            <div class="modal-content">
                <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">添加招聘信息</h5>
                <button type="button" class="close" onclick="closeModal.call(this)">
                    <span aria-hidden="true">&times;</span>
                </button>
                </div>
                <div class="modal-body">

                <!-- 模态框内容 -->
                <form id="recruit_form">
                    <!-- 兼职名称 -->
                    <div class="form-group row">
                        <label for="input_title" class="col-sm-2 text-right">*兼职名称：</label>
                        <div class="col-sm-10">
                            <input id="input_title" class="form-control" type="text" name="title" placeholder="190/天上一休一连锁超市做一休一">
                        </div>
                    </div>
                    <!-- / 兼职名称 -->

                    <!-- 发布人和联系方式 -->
                    <div class="form-group row">
                        <label class="col-sm-2 text-right" for="input_contactName">*发布人：</label>
                        <div class="col-sm-4">
                            <input id="input_recruit_contactName" class="form-control" type="text" name="contactName" placeholder="请输入发布人">
                        </div>
                        <label for="input_recruit_contactPhone" class="col-sm-2 text-right">*联系方式：</label>
                        <div class="col-sm-4">
                            <input id="input_recruit_contactPhone" class="form-control" type="text" name="contactPhone" placeholder="请输入发布人联系方式">
                        </div>
                    </div>
                    <!-- / 发布人和联系方式 -->

                    <!-- 选择工种和招聘人数 -->
                    <div class="form-group row">
                        <label class="col-sm-2 text-right" for="select_job">*选择工种：</label>
                        <div class="col-sm-4">
                            <select id="select_job" class="form-control" name="job">
                                <option style="display: none;">请选择工种信息</option>
                            </select>
                        </div>
                        <label for="input_num" class="col-sm-2 text-right">*招聘人数：</label>
                        <div class="col-sm-4">
                            <input id="input_num" class="form-control" type="text" name="num" placeholder="请输入您要招聘的人数">
                        </div>
                    </div>
                    <!-- / 选择工种和招聘人数 -->

                    <!-- 招聘公司，薪资水平 -->
                    <div class="form-group row">
                        <label class="col-sm-2 text-right" for="select_businessId">*招聘公司：</label>
                        <div class="col-sm-4">
                            <select id="select_businessId" class="form-control" name="businessId">
                                <option style="display: none;">该招聘所属公司</option>
                            </select>
                        </div>
                        <label for="input_salary" class="col-sm-2 text-right">*薪资水平：</label>
                        <div class="col-sm-4">
                            <input id="input_salary" class="form-control" type="text" name="salary" placeholder="请输入薪资">
                        </div>
                    </div>
                    <!-- / 招聘公司，薪资水平 -->

                    <!-- 状态，审核状态 -->
                    <div class="form-group row">
                        <label class="col-sm-2 text-right" for="select_businessId">*状态：</label>
                        <div class="col-sm-4">
                                <input id="input_status" class="form-control" type="text" name="status" placeholder="请输入状态">
                        </div>
                        <label for="input_auditStatus"  class="col-sm-2 text-right">*审核状态：</label>
                        <div class="col-sm-4">
                            <input id="input_auditStatus" class="form-control" type="text" name="auditStatus" placeholder="请输入审核状态">
                        </div>
                    </div>
                    <!-- / 状态，审核状态 -->

                    <!-- 职位标签 -->
                    <div class="form-group row">
                        <label for="input_welfare" class="col-sm-2 text-right">*职位标签：</label>
                        <div class="col-sm-4">
                            <input id="input_welfare" class="form-control" type="text" name="welfare" placeholder="可以手动输入，使用空格隔开">
                        </div>
                        <label for="input_workingHours" class="col-sm-2 text-right">*工作时长：</label>
                        <div class="col-sm-4">
                            <input id="input_workingHours" class="form-control" type="text" name="workingHours" placeholder="请输入工作时长">
                        </div>
                    </div>
                    <!-- / 职位标签 -->

                    <!-- 职位描述 -->
                    <div class="form-group row">
                        <label for="input_description" class="col-sm-2 text-right">*职位描述：</label>
                        <div class="col-sm-10">
                            <input id="input_description" class="form-control" type="textarea" name="description" placeholder="请输入职位描述">
                        </div>
                    </div>
                    <!-- / 职位描述 -->
                
                </form>
                <!-- / 模态框内容 -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" onclick="closeModal.call(this)">关闭</button>
                    <button type="button" class="btn btn-primary" onclick="submitRecruit()">保存</button>
                </div>     
            </div>
        </div>
    </div>
    <!-- /recruit模态框 -->

    <script>
        var Myid;
        var baseURL = "http://203.195.246.58:7777/";
        // 关闭模态框
        function closeModal(){
            $(this).parents(".modal").modal("hide");
        }
        closeModal();
        // =================初始化职位信息===================
        function init_job(){
            var url = baseURL+"/Jobs/findAll";
            $.get(url,function(result){
                // console.log(result.data,"职位");
                result.data.forEach(function(item){
                    $("#add_job").append(`<li>`+item.name+`</li>  `);
                })
            })
        }
        init_job();

        // ================初始化地址信息=================
        function init_address(){
            var url = baseURL+"/Province/findAll";
            $.get(url,function(result){
                // console.log(result.data,"地址");
                // var data = item.data;
                result.data.forEach(function(item){
                    $("#add_address").append(`<li>`+item.name+`</li>  `)
                })
            })
        }
        init_address();
        
        // =================初始化福利信息==================
        function init_welfare(){
            var url = baseURL+"/Welfare/findAll";
            $.get(url,function(result){
                // console.log(result.data,"welfare");
                result.data.forEach(function(item){
                    $("#add_welfare").append(`<li>`+item.name+`</li>  `);
                })
            })
        }
        init_welfare();

        // =================初始化招聘详情================
        function init_recruit(){
            var url = baseURL+"/Employment/findAll";
            $.get(url,function(result){
                // console.log(result.data,"recruit");
                result.data.forEach(function(item){
                    $(".recruit").append(`
                    <div class="row border-bottom">
                        <div class="recruit_details_left mt-2 col-4">
                            <div class="title">`+item.title+`</div>
                            <div class="salary text-danger">`+item.salary+`</div>
                            <div class="welfare btn">
                                <div class="one">五险一金</div>
                                <div class="two">包吃</div>
                                <div class="three">包住</div>
                            </div>
                        </div>
                        <div class="recruit_details_center mt-3 col-5">
                            <div >
                                <span class="workTime">工作时间：`+item.workingHours+`</span>&nbsp;&nbsp;&nbsp;
                                <span class="job">工作类型：`+item.job+`</span>
                            </div>
                            <div>
                                <span class="num">招聘人数：10人</span>&nbsp;&nbsp;&nbsp;
                                <span class="location">工作地点：`+item.location+`</span>
                            </div>
                        </div>
                        <div class="recruit_details_right col-3">
                            <div class="sign_up mt-4">报名参加</div>
                        </div>
                    </div>
                    `)
                })
            })
        }
        init_recruit();

        function modalRecruit(){
            // alert(1);
            var url = baseURL+"/Employment/findAll";
            $.get(url,function(result){
                result.data.forEach(function(item){
                    $("#select_job").append(`<option value="`+item.job+`">`+item.job+`</option>`);
                    $("#select_businessId").append(`<option value="`+item.businessId+`">`+item.businessId+`</option>`);
                })
            })
        }
        modalRecruit();

        // 保存
        function submitRecruit(){
            // alert(1);
            var url = baseURL+"/Employment/saveOrUpdate";
            // 获取模态框里的值
            var title = $("#input_title").val();
            var contactName = $("#input_recruit_contactName").val();
            var contactPhone = $("#input_recruit_contactPhone").val();
            var job = $("#select_job").val();
            var num = $("#input_num").val();
            var businessId = $("#select_businessId").val();
            var salary = $("#input_salary").val();
            var welfare = $("#input_welfare").val();
            var status = $("#input_status").val();
            var auditStatus = $("#input_auditStatus").val();
            // var publishTime = $("#input_publishTime").val();
            var description = $("#input_description").val();
            var workingHours = $("#input_workingHours").val();
            // console.log(contactName,'====')
            // console.log(contactPhone,'----')
            if(Myid){
                var data = {
                    id:Myid,
                    title:title,
                    contactName:contactName,
                    contactPhone:contactPhone,
                    job:job,
                    num:num,
                    businessId:businessId,
                    salary:salary,
                    welfare:welfare,
                    status:status,
                    auditStatus:auditStatus,
                    // publishTime:publishTime,
                    description:description,
                    workingHours:workingHours
                }
            }else{
                var data = {
                title:title,
                contactName:contactName,
                contactPhone:contactPhone,
                job:job,
                num:num,
                businessId:businessId,
                salary:salary,
                welfare:welfare,
                status:status,
                auditStatus:auditStatus,
                // publishTime:publishTime,
                description:description,
                workingHours:workingHours
                }
            }
            // console.log(data,"保存");
            $.post(url,data,function(result){
                // console.log(result.data);
                if(result.status === 200){
                    $("#modal_add_recruit").modal("hide");
                    init_recruit();
                }else{
                    alert("保存接口异常");
                }
            })
        }
        // submitRecruit();

        $(function(){
            // 鼠标点击，改变li的颜色
            $(".types").on("click","li",function(){
                $(this).addClass("current");
                $(this).siblings().removeClass("current");
            })
            // 点击添加，弹出模态框
            $("#post").on("click",function(){
                $("#modal_add_recruit").modal("show");
            })
            // 监听模态框的关闭,模态框关闭时，清除数据
            $("#modal_add_recruit").on("hidden.bs.modal",function(){
                $(this).find("form")[0].reset();
            })   

            // 通过工作筛选职位
            $(".btn_job").on("click",function(){
                // if(className == "btn_job"){
                    var url = baseURL+"/Employment/findByJob";
                    var job = $(this).parents('.search').find('.search_input').val()
                    console.log(job);
                    var data = "job="+job;
                    $.get(url,data,function(result){
                        $(".recruit").empty();
                        result.data.forEach(function(item){
                            $(".recruit").append(`
                                <div class="row border-bottom">
                                    <div class="recruit_details_left mt-2 col-4">
                                        <div class="title">`+item.title+`</div>
                                        <div class="salary text-danger">`+item.salary+`</div>
                                        <div class="welfare btn">
                                            <div class="one">五险一金</div>
                                            <div class="two">包吃</div>
                                            <div class="three">包住</div>
                                        </div>
                                    </div>
                                    <div class="recruit_details_center mt-3 col-5">
                                        <div >
                                            <span class="workTime">工作时间：`+item.workingHours+`</span>&nbsp;&nbsp;&nbsp;
                                            <span class="job">工作类型：`+item.job+`</span>
                                        </div>
                                        <div>
                                            <span class="num">招聘人数：10人</span>&nbsp;&nbsp;&nbsp;
                                            <span class="location">工作地点：`+item.location+`</span>
                                        </div>
                                    </div>
                                    <div class="recruit_details_right col-3">
                                        <div class="sign_up mt-4">报名参加</div>
                                    </div>
                                </div>
                                `)
                        })
                    })
                // }                
            })
        })
    </script>
</body>
</html>